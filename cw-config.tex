\documentclass[oneside,final,14pt]{extreport}
\usepackage[utf8]{inputenc}
\usepackage[T2A,T1]{fontenc}
\usepackage[russian]{babel}
\usepackage{vmargin}
\usepackage[labelsep=endash]{caption}
\usepackage{indentfirst}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{titletoc}
\usepackage{xinttools}
\usepackage{ragged2e}
\usepackage{ulem}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{color}
\usepackage{xstring}
\usepackage[abspath]{currfile}
\usepackage[hidelinks,linktoc=all]{hyperref}

\setpapersize{A4}
\setmarginsrb{1.5cm}{1.5cm}{1cm}{1.5cm}{0pt}{0mm}{0pt}{13mm}
\sloppy

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{
   frame=tb,
   language=C++,
   aboveskip=3mm,
   belowskip=3mm,
   showstringspaces=false,
   columns=flexible,
   basicstyle={\small\ttfamily},
   numbers=none,
   numberstyle=\tiny\color{gray},
   keywordstyle=\color{blue},
   commentstyle=\color{dkgreen},
   stringstyle=\color{mauve},
   breaklines=true,
   breakatwhitespace=true,
   tabsize=3,
   literate=%
      {©}{{\copyright}}{4},
   emptylines=0
}

\newcommand{\runtimeFsep}{/}
\newcommand{\updateRuntimeFsep}{\IfSubStr{\currfileabsdir}{/}{}{\renewcommand{\runtimeFsep}{\backslash}}}

\updateRuntimeFsep

\makeatletter
\DeclareRobustCommand{\filename}[2][]{%
   \begingroup
   % \lstname seems to change hyphens into \textendash
   \def\textendash{-}%
   \filename@parse{#2}%
   \IfSubStr{\filename@base}{\runtimeFsep}{\filename@parse{\filename@base}}{}%
   \edef\filename@base{\detokenize\expandafter{\filename@base}}%
   #1{\filename@base.\filename@ext}%
   \endgroup
}

\newcommand\inputcode[3][]{
   {\bfseries #1\filename{#2}}:
   \lstinputlisting[%
      #3,
   ]{#2}%
}

\renewcommand*{\@alph}[1]{%
  \ifcase#1\or а\or б\or в\or г\or
    д\or е\or ё\or ж\or з\or и\or й\or
    к\or л\or м\or н\or о\or п\or р\or с\or т\or
    у\or ф\or х\or ц\or ч\or
    ш\or щ\or ы\or э\or у \or я
    \else\@ctrerr\fi
}
\renewcommand*{\@Alph}[1]{%
  \ifcase#1\or А\or Б\or В\or Г\or
  Д\or Е\or Ё\or Ж\or З\or И\or Й\or
  К\or Л\or М\or Н\or О\or П\or Р\or С\or Т\or
  У\or Ф\or Х\or Ц\or Ч\or
  Ш\or Щ\or Ы\or Э\or У\or Я
  \else\@ctrerr\fi
}
\makeatother

\titleformat{\chapter}[display]
{\normalfont\large\bfseries}{\chaptertitlename\ \thechapter}{20pt}{\Large}

\newcommand\tcchapter[1]{%
   \chapter*{#1}%
   \addcontentsline{toc}{chapter}{#1}
}

\onehalfspacing

% NormalTeXSyntaxON
\def\setcase#1 {\expandafter\def\csname col:#1\endcsname}
\def\taskFileName#1{\expandafter\ifx\csname col:#1\endcsname\relax \coldefault
   \else \csname col:#1\endcsname\fi}

\def\coldefault {code/taskN.cpp}
\setcase 1      {code/task1.cpp}
\setcase 2      {code/task2.cpp}
\setcase 3      {code/task3.cpp}
\setcase 4      {code/task4.cpp}
\setcase 5      {code/task5.cpp}
\setcase 6      {code/task6.cpp}
\setcase 7      {code/task7.cpp}
\setcase 8      {code/task8.cpp}
\setcase 9      {code/task9.cpp}

% NormalTeXSyntaxOff

\contentsmargin{2.55em}
\dottedcontents{chapter}[3.8em]{}{2.3em}{1pc}
\dottedcontents{section}[11.1em]{}{8.2em}{1pc}

\addto\captionsrussian{% Replace "english" with the language you use
  \renewcommand{\contentsname}%
    {Содержание}%
}

\addto\captionsrussian{\renewcommand{\figurename}{Рисунок }}
